(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{iLFW:function(e,t,a){"use strict";var o=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(a("MVZn")),n=o(a("o0o1")),c=a("Be1T"),i=a("P9HM"),u=a("uI15"),l={namespace:"basicTradeForm",state:{fuzzySymbol:void 0,exchange:void 0,priceAutoComplete:"MANUAL",price:0,direction:void 0,tick:void 0,step:1e-4,mixContractMap:new Map,form:void 0},effects:{updateTick:n.default.mark(function e(t,a){var o,r,c;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o=t.payload,r=a.put,c=o,e.next=5,r({type:"updateStateTick",payload:c});case 5:case"end":return e.stop()}},e,this)}),update:n.default.mark(function e(t,a){var o,r,c;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o=t.payload,r=a.put,c=o,e.next=5,r({type:"updateState",payload:c});case 5:case"end":return e.stop()}},e,this)}),reset:n.default.mark(function e(t,a){var o,r,c;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o=t.payload,r=a.put,c=o,e.next=5,r({type:"resetState",payload:c});case 5:case"end":return e.stop()}},e,this)}),updateContracts:n.default.mark(function e(t,a){var o,r,c;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o=t.payload,r=a.put,c=o,e.next=5,r({type:"updateStateContracts",payload:c});case 5:case"end":return e.stop()}},e,this)}),fetchContracts:n.default.mark(function e(t,a){var o,i,u,l;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o=t.payload,i=a.call,u=a.put,e.next=4,i(c.queryContracts,(0,r.default)({},o,{token:sessionStorage.getItem("token")}));case 4:return l=e.sent,e.next=7,u({type:"saveContracts",payload:l&&l.data&&Array.isArray(l.data)?l.data:[]});case 7:case"end":return e.stop()}},e,this)})},reducers:{updateState:function(e,t){var a,o,n=1e-4;if((null!=t.payload.fuzzySymbol&&void 0!==t.payload.fuzzySymbol?a=t.payload.fuzzySymbol:null!=e.fuzzySymbol&&void 0!==e.fuzzySymbol&&(a=e.fuzzySymbol),null!=a&&void 0!==a)&&(null!=t.payload.exchange&&void 0!==t.payload.exchange?o=t.payload.exchange:null!=e.exchange&&void 0!==e.exchange&&(o=e.exchange),null!=o&&void 0!==o&&(a="".concat(a,".").concat(o)),null!=e.mixContractMap&&void 0!==e.mixContractMap&&e.mixContractMap.has(a))){var c=e.mixContractMap.get(a);n=c.priceTick}var i=0;return null!=t.payload.price&&void 0!==t.payload.price?i=t.payload.price:null!=e.price&&void 0!==e.price&&(i=e.price),i=(0,u.roundWithStep)(i,n),(0,r.default)({},e,t.payload,{step:n,price:(0,u.numberFormat)(i,4)})},resetState:function(){return{fuzzySymbol:void 0,exchange:void 0,priceAutoComplete:"MANUAL",price:0,direction:void 0,step:1e-4}},saveContracts:function(e,t){var a=new Map;return t.payload.forEach(function(e){a.set(e.rtContractID,e),a.set(e.rtSymbol,e),a.set(e.symbol,e),a.set("".concat(e.symbol,".").concat(e.gatewayID),e)}),(0,r.default)({},e,{mixContractMap:a})},updateStateContracts:function(e,t){return t.payload.forEach(function(t){e.mixContractMap.set(t.rtSymbol,t),e.mixContractMap.set(t.rtContractID,t),e.mixContractMap.set(t.symbol,t),e.mixContractMap.set("".concat(t.symbol,".").concat(t.gatewayID),t)}),(0,r.default)({},e,{mixContractMap:e.mixContractMap})},updateStateTick:function(e,t){var a=t.payload;if(null==e.fuzzySymbol||void 0===e.fuzzySymbol||void 0===e.direction||null===e.direction||"MANUAL"===e.priceAutoComplete)return e;var o=e.fuzzySymbol;null!=e.exchange&&void 0!==e.exchange&&(o="".concat(e.fuzzySymbol,".").concat(e.exchange));var n=null;if(a.forEach(function(t){null!=e.exchange&&void 0!==e.exchange?o===t.rtSymbol&&(n=t):o===t.symbol&&(n=t)}),null!=n&&void 0!==n){var c=e.price;if(null!=e.priceAutoComplete&&void 0!==e.priceAutoComplete)if("LASTPRICE"===e.priceAutoComplete)c=n.lastPrice;else if("ACTIVE"===e.priceAutoComplete)e.direction===i.DIRECTION_LONG?c=n.askPrice1:e.direction===i.DIRECTION_SHORT&&(c=n.bidPrice1);else if("QUEUE"===e.priceAutoComplete)e.direction===i.DIRECTION_LONG?c=n.bidPrice1:e.direction===i.DIRECTION_SHORT&&(c=n.askPrice1);else if("ADD2"===e.priceAutoComplete)if(null!=e.mixContractMap&&void 0!==e.mixContractMap&&e.mixContractMap.has(o)){var l=e.mixContractMap.get(o),p=l.priceTick;e.direction===i.DIRECTION_LONG?c=n.askPrice1+2*p:e.direction===i.DIRECTION_SHORT&&(c=n.bidPrice1-2*p)}else c=n.lastPrice;return(0,r.default)({},e,{price:(0,u.numberFormat)(c,4),tick:n})}return e}}};t.default=l}}]);